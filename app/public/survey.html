<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>FriendFinder</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- add additional styling from style.css file -->
    <link rel="stylesheet" href="../../assets/style.css">
</head>

<body>

    <!-- modal box to pop up with survey match results- is hidden initially-->
    <div class="modal fade" tabindex="-1" role="dialog" id="myModal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="false">&times;</span>
                    </button>
                    <h4 class="modal-title">Meet your new bestie!</h4>
                </div>
                <div class="modal-body">
                    <div id="newFriendName"></div>
                    <div id="newFriendImage"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Top section of survey page with form for name and link to user photo-->
    <div class="container">
        <div class="row">
            <h2>Survey Questions</h2>
            <hr>
            <h3>
                <b>
                    About You</b>
            </h3>
            <div class="form-group">
                <p1>Name (Required)</p1>
                <input type="text" class="form-control" id="name">
            </div>
            <div class="form-group">
                <p1>Link to Photo Image (Required)</p1>
                <input type="text" class="form-control" id="photo">
            </div>
            <hr>

            <!-- survey questions with drop down selection from 1 to 5 -->
            <div class="form-group">
                <label for="question_one">
                    <h3>
                        <b>Question 1</b>
                    </h3>
                </label>
                <br>
                <p1>You lead a very active lifestyle.</p1>
                <br>
                <select class="form-control" id="sel1" name="sel_one">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_two">
                    <h3>
                        <b>Question 2</b>
                    </h3>
                </label>
                <br>
                <p1>You enjoy watching your favorite sports team on television.</p1>
                <br>
                <select class="form-control" id="sel2" name="sel_two">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_three">
                    <h3>
                        <b>Question 3</b>
                    </h3>
                </label>
                <br>
                <p1>You enjoy going to the movie theater even though netflix is cheaper.</p1>
                <br>
                <select class="form-control" id="sel3" name="sel_three">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_four">
                    <h3>
                        <b>Question 4</b>
                    </h3>
                </label>
                <br>
                <p1>When you hear music you can't help but dance.</p1>
                <br>
                <select class="form-control" id="sel4" name="sel_four">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_five">
                    <h3>
                        <b>Question 5</b>
                    </h3>
                </label>
                <br>
                <p1>You have done things that would be considered adventurous.</p1>
                <br>
                <select class="form-control" id="sel5" name="sel_five">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_six">
                    <h3>
                        <b>Question 6</b>
                    </h3>
                </label>
                <br>
                <p1>You enjoy spending an evening playing games and hanging with friends.</p1>
                <br>
                <select class="form-control" id="sel6" name="sel_six">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_seven">
                    <h3>
                        <b>Question 7</b>
                    </h3>
                </label>
                <br>
                <p1>You sometimes find yourself pondering the meaning of it all.</p1>
                <br>
                <select class="form-control" id="sel7" name="sel_seven">

                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_eight">
                    <h3>
                        <b>Question 8</b>
                    </h3>
                </label>
                <br>
                <p1>You love animals, especially your pets.</p1>
                <br>
                <select class="form-control" id="sel8" name="sel_eight">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_nine">
                    <h3>
                        <b>Question 9</b>
                    </h3>
                </label>
                <br>
                <p1>You sometimes spend hours reading books.</p1>
                <br>
                <select class="form-control" id="sel9" name="sel_nine">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question_ten">
                    <h3>
                        <b>Question 10</b>
                    </h3>
                </label>
                <br>
                <p1>You are a very laid back person.</p1>
                <br>
                <select class="form-control" id="sel10" name="sel_ten">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <button type="submit" id="submit" class="btn btn-primary btn-block btn-lg">
                <span class="glyphicon glyphicon-ok-sign"></span> Submit</button>
            <hr>
            <p>

                <!-- links to friends data and github repository -->
                <a href="/api/friends">API Friends List</a>
                |
                <a href="https://github.com/DMWIGGINS/FriendFinder">GitHub Repo</a>
            </p>
        </div>
    </div>

</body>

</html>

<!-- javascript to grab data from survey when submit button is clicked -->
<script type="text/javascript">
    $("#submit").on("click", function (event) {
        event.preventDefault();
        alert("clicked");

        // collects responses from 10 questions and adds them to our scoreArray
        var scoreArray = [];
        for (i = 1; i < 11; i++) {
            var collectScores = $("#sel" + i).val().trim();
            scoreArray.push(collectScores);
        };

        // convert scoreArray to a string so it is compatable to be used with our jQuery $..post
        var scoreString = scoreArray.toString();

        // creating our newFriends object with the form and survey data
        var newFriends = {
            name: $("#name").val().trim(),
            photo: $("#photo").val().trim(),
            scores: scoreString
        };

        console.log(newFriends.scores);
        console.log(newFriends);

        // sending our newFriends object as a request to find best match in friends api
        // will return result via data callback
        $.post("/api/friends", newFriends,
            function (data) {
                console.log(data.name);
                console.log(data.photo);

                if (data) {

                    // show result in modal popup by appending name and photo link of best match to modal id
                    $("#newFriendName").text(data.name);
                    var friendPhoto = $("<img>")
                    $(friendPhoto).attr("src", data.photo);
                    $("#newFriendImage").html(friendPhoto);
                    $('#myModal').modal("show");

                } else {

                    // if something goes wrong and returns no data then show this message
                    alert("Sorry you have no match.....try again.");
                }
                // clearing values from survey after submitted
                for (i = 1; i < 11; i++) {
                    $("#sel" + i).val("");
                }
                $("#name").val("");
                $("#photo").val("");

            });

    });
</script>
